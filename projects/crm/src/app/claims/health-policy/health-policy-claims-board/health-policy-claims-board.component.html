<div class="sm:w-10/12 mx-auto mt-6">
  <crm-form-section-divider title="Претенции по Медицинска застраховка" class="page-title"></crm-form-section-divider>

  <cdk-accordion class="accordion">
    <cdk-accordion-item
      *ngFor="let item of items; let index = index"
      #accordionItem="cdkAccordionItem"
      class="accordion-item accordion-item-shadow-box"
      role="button"
      tabindex="0"
      [attr.id]="'accordion-header-' + index"
      [attr.aria-expanded]="accordionItem.expanded"
      [attr.aria-controls]="'accordion-body-' + index"
    >
      <div
        [ngClass]="!item.isLight ? 'accordion-item-header-active' : 'accordion-item-header'"
        (click)="accordionItem.toggle()"
      >
        <div class="accordion-item-header-content">
          <div>Претенция&nbsp;&#8470;:&nbsp;</div>
          <div>{{ item.claimNumTr }}</div>
        </div>
        <div class="accordion-item-header-content">
          <div class="status-key">статус:&nbsp;</div>
          <div class="status">{{ item.claimStatus }}</div>
        </div>
      </div>
      <div class="accordion-item-content" (click)="accordionItem.toggle()">
        <div>
          <div class="accordion-item-content-container">
            <div class="accordion-item-content-container-child">
              <b>Здравна карта&nbsp;&#8470;:</b>
            </div>
            <div class="accordion-item-content-container-child">
              {{ item.insuranceCardNumber }}
            </div>
          </div>
          <div class="accordion-item-content-container">
            <div class="accordion-item-content-container-child">
              <b>Дата на заявяване:</b>
            </div>
            <div class="accordion-item-content-container-child">{{ item.claimDate | date: 'dd.MM.yyyy' }}&nbsp;г.</div>
          </div>
          <div *ngIf="hasApprovedDate(item.approvedDate)" class="accordion-item-content-container">
            <div class="accordion-item-content-container-child">
              <b>Дата на решение:</b>
            </div>
            <div class="accordion-item-content-container-child">
              {{ item.approvedDate | date: 'dd.MM.yyyy' }}&nbsp;г.
            </div>
          </div>
          <div *ngIf="item.claimStatus === 'Изплатен'" class="accordion-item-content-container">
            <div class="accordion-item-content-container-child">
              <b>Дата на плащане:</b>
            </div>
            <div class="accordion-item-content-container-child">
              {{ item.paymentDate | date: 'dd.MM.yyyy' }}&nbsp;г.
            </div>
          </div>
          <div class="accordion-item-content-container">
            <div class="accordion-item-content-container-child">
              <b>Застрахован:</b>
            </div>
            <div class="accordion-item-content-container-child">
              {{ item.insuredPersonName }}
            </div>
          </div>

          <div class="accordion-item-content-container">
            <div class="accordion-item-content-container-child">
              <b>ЕГН:</b>
            </div>
            <div class="accordion-item-content-container-child">
              {{ item.pin }}
            </div>
          </div>
          <div class="accordion-item-content-container">
            <div class="btn-axiom-package-box">
              <div class="btn-axiom-box-buttons">
                <div class="btn-axiom" (click)="accordionItem.toggle()">
                  <button class="btn-axiom-package-content" type="button" (click)="accordionItem.toggle()">
                    Пакети
                  </button>
                </div>
                <div class="btn-axiom ml-2 sm:ml-4">
                  <button
                    class="btn-axiom-package-content"
                    type="button"
                    (click)="openDialog(item.claimNumTr ?? '', item.canUpload ?? false)"
                  >
                    Документи
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div
        class="accordion-item-body"
        role="region"
        [style.display]="accordionItem.expanded ? '' : 'none'"
        [attr.id]="'accordion-body-' + index"
        [attr.aria-labelledby]="'accordion-header-' + index"
      >
        <div class="accordion-item-content-container">
          <div class="package-list">
            <b>Списък с пакети</b>
          </div>
        </div>
        <div class="package-container wrap">
          <div class="package-item package-item-shadow-box mb-3" *ngFor="let claim of item.details; let index = index">
            <div
              [ngClass]="
                !item.isLight
                  ? 'package-item-header text-lg sm:text-xl'
                  : 'package-item-header-light text-lg sm:text-xl'
              "
            >
              {{ claim.packageName }}
            </div>
            <div class="package-limit-tabe">
              <div class="package-limit-table-body">
                <div class="package-limit-table-row">
                  <div class="package-limit-table-cell-header"><span>Предявена сума за услуги</span></div>
                  <div class="package-limit-table-cell" align="right">
                    {{ claim.servicesAmount | number: '1.2-2' }}
                  </div>
                </div>
              </div>
            </div>
            <div class="package-limit-tabe">
              <div class="package-limit-table-body">
                <div class="package-limit-table-row">
                  <div class="package-limit-table-cell-header"><span>Одобрена сума за услуги</span></div>
                  <div class="package-limit-table-cell" align="right">
                    {{ claim.approvedServicesAmount | number: '1.2-2' }}
                  </div>
                </div>
              </div>
            </div>
            <div class="package-limit-tabe">
              <div class="package-limit-table-body">
                <div class="package-limit-table-row">
                  <div class="package-limit-table-cell-header"><span>Предявена сума за медикаменти</span></div>
                  <div class="package-limit-table-cell" align="right">
                    {{ claim.drugsAmount | number: '1.2-2' }}
                  </div>
                </div>
              </div>
            </div>
            <div class="package-limit-tabe">
              <div class="package-limit-table-body">
                <div class="package-limit-table-row">
                  <div class="package-limit-table-cell-header"><span>Одобрена сума за медикаменти</span></div>
                  <div class="package-limit-table-cell" align="right">
                    {{ claim.approvedDrugsAmount | number: '1.2-2' }}
                  </div>
                </div>
              </div>
            </div>
            <div class="package-limit-tabe">
              <div class="package-limit-table-body">
                <div class="package-limit-table-row">
                  <div class="package-limit-table-cell-header"><span>Самоучастие</span></div>
                  <div class="package-limit-table-cell" align="right">
                    {{ claim.packFranchServ | number: '1.2-2' }}
                  </div>
                </div>
              </div>
            </div>
            <div class="package-limit-tabe">
              <div class="package-limit-table-body">
                <div class="package-limit-table-row">
                  <div class="package-limit-table-cell-header"><span>Валута</span></div>
                  <div class="package-limit-table-cell" align="right">
                    {{ claim.currencyCode }}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </cdk-accordion-item>
  </cdk-accordion>
</div>
