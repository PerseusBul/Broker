<div class="sm:w-10/12 mx-auto mt-6">
  <crm-form-section-divider title="Полици по Медицинска застраховка" class="page-title"></crm-form-section-divider>
  <cdk-accordion class="accordion">
    <cdk-accordion-item
      *ngFor="let item of items; let index = index"
      #accordionItem="cdkAccordionItem"
      class="accordion-item accordion-item-shadow-box"
      role="button"
      tabindex="0"
      [attr.id]="'accordion-header-' + index"
      [attr.aria-expanded]="accordionItem.expanded"
      [attr.aria-controls]="'accordion-body-' + index"
    >
      <div
        [ngClass]="item.insuranceStatusCode === 'A' ? 'accordion-item-header-active' : 'accordion-item-header'"
        (click)="accordionItem.toggle()"
      >
        <div class="accordion-item-header-content">
          {{ item.insuranceType }}&nbsp;&#8470;: &nbsp;{{ item.contractNumber }}
        </div>

        <div class="accordion-item-header-content">
          {{ item.insuranceStatus | uppercase }}
        </div>
      </div>
      <div class="accordion-item-content" (click)="accordionItem.toggle()">
        <div>
          <div class="accordion-item-content-container">
            <div class="accordion-item-content-container-child">
              <b>Карта&nbsp;&#8470;:</b>
            </div>
            <div class="accordion-item-content-container-child">
              {{ item.insuranceCardNumber }}
            </div>
          </div>
          <div class="accordion-item-content-container">
            <div class="accordion-item-content-container-child">
              <b>Валидна от:</b>
            </div>
            <div class="accordion-item-content-container-child">{{ item.beginDate | date: 'dd.MM.yyyy' }}&nbsp;г.</div>
          </div>
          <div class="accordion-item-content-container">
            <div class="accordion-item-content-container-child">
              <b>Валидна до:</b>
            </div>
            <div class="accordion-item-content-container-child">{{ item.endDate | date: 'dd.MM.yyyy' }}&nbsp;г.</div>
          </div>
          <div class="accordion-item-content-container">
            <div class="accordion-item-content-container-child">
              <b>Застрахован:</b>
            </div>
            <div class="accordion-item-content-container-child">
              {{ item.insuredPersonName }}
            </div>
          </div>
          <div class="accordion-item-content-container">
            <div class="accordion-item-content-container-child">
              <b>ЕГН:</b>
            </div>
            <div class="accordion-item-content-container-child">
              {{ item.egn }}
            </div>
          </div>
          <div class="accordion-item-content-container">
            <div class="btn-axiom-package-box">
              <div class="btn-axiom-box-buttons">
                <div class="btn-axiom" (click)="accordionItem.toggle()">
                  <button class="btn-axiom-package-content" type="button" (click)="accordionItem.toggle()">
                    <span>Пакети</span>
                  </button>
                </div>
                <div class="btn-axiom ml-2 sm:ml-4">
                  <div class="btn-axiom-package-content">
                    <a routerLink="/crm/claims/health-policy/{{ item.insuranceCardNumber }}">Претенции</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div
        class="accordion-item-body"
        role="region"
        [style.display]="accordionItem.expanded ? '' : 'none'"
        [attr.id]="'accordion-body-' + index"
        [attr.aria-labelledby]="'accordion-header-' + index"
      >
        <div class="accordion-item-content-container">
          <div class="package-list">
            <b>Списък с пакети</b>
          </div>
        </div>
        <div class="package-container wrap">
          <div class="package-item package-item-shadow-box" *ngFor="let package of item.packages; let index = index">
            <div
              [ngClass]="
                item.insuranceStatusCode === 'A'
                  ? 'package-item-header text-lg sm:text-xl'
                  : 'package-item-header-light text-lg sm:text-xl'
              "
            >
              <span class="package-item-header-content">{{ package.packageName }}</span>
            </div>
            <div class="package-limit-tabe">
              <div class="package-limit-table-body">
                <div class="package-limit-table-row">
                  <div class="package-limit-table-cell-header"><span>Застрахователен лимит</span></div>
                  <div *ngIf="package.yearPayoffLimit !== 999999" class="package-limit-table-cell" align="right">
                    {{ package.yearPayoffLimit | number: '1.2-2' }}
                  </div>
                  <div *ngIf="package.yearPayoffLimit === 999999" class="package-limit-table-cell" align="right">
                    без лимит
                  </div>
                </div>
              </div>
            </div>
            <div class="package-limit-tabe">
              <div class="package-limit-table-body">
                <div class="package-limit-table-row">
                  <div class="package-limit-table-cell-header"><span>Изплатено обезщетение</span></div>
                  <div class="package-limit-table-cell" align="right">{{ package.payAmount | number: '1.2-2' }}</div>
                </div>
              </div>
            </div>
            <div class="package-limit-tabe">
              <div class="package-limit-table-body">
                <div class="package-limit-table-row">
                  <div class="package-limit-table-cell-header"><span>Остатъчен лимит</span></div>
                  <div *ngIf="package.limitRemainderAgr !== 999999" class="package-limit-table-cell" align="right">
                    {{ package.limitRemainderAgr | number: '1.2-2' }}
                  </div>
                  <div *ngIf="package.limitRemainderAgr === 999999" class="package-limit-table-cell" align="right">
                    без лимит
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="accordion-item-content-container"></div>
      </div>
    </cdk-accordion-item>
  </cdk-accordion>
  <mat-checkbox
    class="heath-policy-board-checkbox text-ellipsis overflow-hidden"
    [checked]="checked"
    (change)="onShowChecked()"
  >
    Покажи всички полици (вкл. неактивни)
  </mat-checkbox>
</div>
